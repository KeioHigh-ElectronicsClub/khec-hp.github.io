<!DOCTYPE html> <!-- この行では、この文書がHTML5(最新バージョンのHTML)で記述されたものであると宣言しています。-->
<html>

<head>
    <!-- <head>と</head>の間にタイトルや文字コード等、ページ本体には表示しない「設定」の様な情報を記述します。 -->
    <meta charset="UTF-8"> <!-- この行では、文字コードをUTF-8に設定しています。 -->
    <title>自己紹介</title>
    <!-- <style>と</style>の間に、CSSを書きます。 -->
    <style>
        body {
            background: url("images/background.jpg");
            background-size: cover;
            margin-left: 80px;
        }

        .au- {
            font-family: cursive;
        }

        h1 {
            font-size: 200%;
        }

        .ua- {
            font-size: 100%;
        }

        input,
        textarea {
            vertical-align: bottom;
            background-color: #C0C0C0;
            float: right;
        }

        h2 {
            padding: 0.25em 0.5em;
            color: #494949;
            background: transparent;
            border-left: solid 5px #7db4e6;
        }
    </style>
</head>

<body background="">
    <!-- <body>と</body>の間に、文章等のページ本体に表示したい内容を記述します。 -->



    <h1 id="nickname" class="au-">wawawa113</h1>
    <img src="images/my_image.jpg" alt="my image" width="110px" heigh="110px"> <br>
    <var class="ua-">

        <h2>役職・班</h2>
        イベント係 C++班　タイミングゲーム班　テキスト作成班<br><br>

        <h2>以前作った作品</h2>
        行列計算ライブラリ　 フレンズな言語Kemonoのコンパイラ（このぺーじにかくれてるよ）<br>
        -&gt;Kemonoって？ <a href="https://github.com/consomme/kemono_friends_lang">軽量さを突き詰めた言語だよ！すっごーい！</a><br><br>

        <h2>電工研に入った理由</h2>
        面白い人が居そうだったから。<br><br>

        <h2>好きな言語</h2>
        C++<br><br>

        <h2>嫌いな言語</h2>
        C++<br><br>

        <h2>C++の好きな言語機能</h2>
        テンプレート　オペレータオーバーロード　テンプレート

    </var>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>

    <br>
    <br>
    <br>

    <input type="button" onclick="onbuttonClick()" style="width:100px; height:100px" value="Run!"><textarea
        id="input_code" rows="10" cols="100" placeholder="Enter your code.."></textarea>
</body>
<script>
    window.onload = function () {
        console.log("君はコンソールを見るフレンズなんだね！");
        console.log("ここはフレンズなプログラミング言語、");
        console.log("Kemonoを実行した結果が出てくるよ！");
        console.log("ページ下に入力欄があるから入力してね！！");
        console.log("_____________________________________________________________");
        console.log(" ##   ##  #######  ####     ####      #####               ");
        console.log(" ##   ##   ##   #   ##       ##      ##   ##              ");
        console.log(" ##   ##   ## #     ##       ##      ##   ##              ");
        console.log(" #######   ####     ##       ##      ##   ##              ");
        console.log(" ##   ##   ## #     ##   #   ##   #  ##   ##              ");
        console.log(" ##   ##   ##   #   ##  ##   ##  ##  ##   ##              ");
        console.log(" ##   ##  #######  #######  #######   #####               ");
        console.log("                                                          ");
        console.log("            ##   ##   #####   ######   ####     #####     ");
        console.log("            ##   ##  ##   ##   ##  ##   ##       ## ##    ");
        console.log("            ##   ##  ##   ##   ##  ##   ##       ##  ##   ");
        console.log("            ## # ##  ##   ##   #####    ##       ##  ##   ");
        console.log("            #######  ##   ##   ## ##    ##   #   ##  ##   ");
        console.log("            ### ###  ##   ##   ##  ##   ##  ##   ## ##    ");
        console.log("            ##   ##   #####   #### ##  #######  #####     ");
        console.log("_____________________________________________________________");
        console.log("");
        console.log("Result:")
    }
    //infra
    function onbuttonClick() {
        const input_code = document.getElementById("input_code").value;
        try{
            console.log(app_compiler(input_code));
        }
        catch(e){
            console.log(e);
        }
    }

    //app
    function app_compiler(app_code) {
        var pair_uwa_wai = domain_pair_find(domain_split(app_code));
        var pair_wai_uwa = {};
        for (let key in pair_uwa_wai) {
            let tmp = pair_uwa_wai[key];
            pair_wai_uwa[tmp] = Number(key);
        }
        return domain_compile(domain_split(app_code), pair_uwa_wai, pair_wai_uwa);
    }

    //domain
    function domain_pair_find(words) {
        var uwa_ = [];
        var wa_i = [];
        for (let i = 0; i < words.length; i++) {
            if (words[i] == 'うわー') {
                uwa_.push(i);
            } else if (words[i] == 'わーい') {
                wa_i.push(i);
            }
        }
        if(uwa_.length!=wa_i.length){
            throw "うわー！とわーい！の個数が合いません。" ;
        }
        var pair_uwa_and_wa_i = {};   //key uwa and params wai
        var pair_wa_i_and_uwa_ = {};
        var pair_uwa_;
        var pair_wa_i;
        var pair_uwa_index;
        var pair_wa_i_index;
        while (uwa_.length > 0) {
            let min_dis = 100000;
            for (let i = 0; i < uwa_.length; i++) {
                for (let j = 0; j < wa_i.length; j++) {
                    let dis = wa_i[j] - uwa_[i];
                    if (dis > 0) {
                        if (min_dis > dis) {
                            min_dis = dis;
                            pair_uwa_index = i;
                            pair_wa_i_index = j;
                            pair_uwa_ = uwa_[i];
                            pair_wa_i = wa_i[j];
                        }
                    }
                }
            }
            uwa_.splice(pair_uwa_index, 1);
            wa_i.splice(pair_wa_i_index, 1);
            pair_uwa_and_wa_i[pair_uwa_] = pair_wa_i;
        }
        return pair_uwa_and_wa_i;
    }

    function domain_split(split_code) {
        const splited_words = String(split_code).split('！');
        splited_words.pop(); // for the void value happen when code was splited.
        return splited_words;
    }

    function domain_compile(compile_words, pair_uwa_wai, pair_wai_uwa) {
        var num_array = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];      //i dont know so much about array in javascript sorry...
        var now_index = 0;
        var output = "";
        var last_uwa_ = "";
        for (let i = 0; i < compile_words.length; i++) {
            switch (compile_words[i]) {
                case 'たのしー':
                    now_index++;
                    if(now_index>1000000){
                        throw "処理時間が長すぎたので無限ループと判断しました。";
                    }
                    break;
                case 'たーのしー':
                    num_array[now_index]++;
                    if(num_array[now_index]>1000000){
                        throw "処理時間が長すぎたので無限ループと判断しました。";
                    }
                    break;
                case 'すごーい':
                    now_index--;
                    if(now_index<0){
                        throw "アドレスが０を下回った為、エラーと判断しました。";
                    }
                    break;
                case 'すっごーい':
                    num_array[now_index]--;
                    if(num_array[now_index]<-1000000){
                        throw "処理時間が長すぎたので無限ループと判断しました。"
                    }
                    break;
                case 'うわー':
                    if (num_array[now_index] == 0) {
                        i = pair_uwa_wai[i];
                    }
                    break;

                case 'わーい':
                    if (num_array[now_index] != 0) {
                        i = pair_wai_uwa[i];
                    }
                    break;

                case 'なにこれなにこれ':
                    output += String.fromCharCode(num_array[now_index]);
                    break;
                default:
                    throw "想定されていないワードが含まれています。　もしかして：空白・改行";
            }
        }

        return output;
    }

</script>

</html>